var t={d:(e,s)=>{for(var r in s)t.o(s,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:s[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};t.d(e,{P:()=>i,Z:()=>i});const s=Math.pow(2,31)-1;function r(t){throw new TypeError("Cron parser: "+t)}function n(t,e){for(let s=0;s<t.length;s++)t[s]=e;return t}function a(t){this.milliseconds=t.getMilliseconds(),this.seconds=t.getSeconds(),this.minutes=t.getMinutes(),this.hours=t.getHours(),this.days=t.getDate(),this.months=t.getMonth(),this.years=t.getFullYear()}function o(t){this.pattern=t,this.seconds=n(Array(60),0),this.minutes=n(Array(60),0),this.hours=n(Array(24),0),this.days=n(Array(31),0),this.months=n(Array(12),0),this.daysOfWeek=n(Array(8),0),this.parse()}function i(t,e,s){let r=this;return this instanceof i?(r.pattern=new o(t),r.schedulerDefaults={stopAt:1/0,maxRuns:1/0,kill:!1},"function"==typeof e&&(s=e,e={}),r.opts=r.validateOpts(e||{}),void 0===s?r:this.schedule(e,s)):new i(t,e,s)}a.prototype.increment=function(t){this.seconds+=1,this.milliseconds=0;let e=this,s=function(t,s,r,n){for(let a=void 0===n?e[t]+r:0+r;a<s[t].length;a++)if(s[t][a])return e[t]=a-r,!0;return!1},r=[["seconds","minutes",0],["minutes","hours",0],["hours","days",0],["days","months",-1],["months","years",0]],n=0;for(;n<5;){if(!s(r[n][0],t,r[n][2]))for(this[r[n][1]]++;n>=0;)s(r[n][0],t,r[n][2],0),n--;n++}for(;!t.daysOfWeek[this.getDate().getDay()];)this.days+=1},a.prototype.getDate=function(){return new Date(this.years,this.months,this.days,this.hours,this.minutes,this.seconds,this.milliseconds)},o.prototype.parse=function(){"string"!=typeof this.pattern&&this.pattern.constructor!==String&&r("Pattern has to be of type string.");let t,e,s,n,a,o=this.pattern.trim().replace(/\s+/g," ").split(" "),i=/[^/*0-9,-]+/;for(6!==o.length&&r("invalid configuration format ('"+this.pattern+"'), exacly five space separated parts required."),e=0;e<o.length;e++)t=o[e].trim(),i.test(t)&&r("configuration entry "+(e+1)+" ("+t+") contains illegal characters.");s="*"!==o[4],n="*"!==o[5],a="*"!==o[3],n&&(s||a)&&r("configuration invalid, you can not combine month/date with day of week."),this.partToArray("seconds",o[0],0),this.partToArray("minutes",o[1],0),this.partToArray("hours",o[2],0),this.partToArray("days",o[3],-1),this.partToArray("months",o[4],-1),this.partToArray("daysOfWeek",o[5],0),this.daysOfWeek[7]&&(this.daysOfWeek[0]=1)},o.prototype.partToArray=function(t,e,s){let n,a,o,i,l,u=this[t];if("*"!==e)if(a=e.split(","),a.length>1)for(n=0;n<a.length;n++)this.partToArray(t,a[n],s);else if(-1!==e.indexOf("-"))for(a=e.split("-"),2!==a.length&&r("Syntax error, illegal range: '"+e+"'"),o=parseInt(a[0],10)+s,i=parseInt(a[1],10)+s,isNaN(o)?r("Syntax error, illegal lower range (NaN)"):isNaN(i)&&r("Syntax error, illegal upper range (NaN)"),(o<0||i>=u.length)&&r("Value out of range: '"+e+"'"),o>i&&r("From value is larger than to value: '"+e+"'"),n=o;n<=i;n++)u[n+s]=1;else if(-1!==e.indexOf("/"))for(a=e.split("/"),2!==a.length&&r("Syntax error, illegal stepping: '"+e+"'"),"*"!==a[0]&&r("Syntax error, left part of / needs to be * : '"+e+"'"),l=parseInt(a[1],10),isNaN(l)&&r("Syntax error, illegal stepping: (NaN)"),0===l&&r("Syntax error, illegal stepping: 0"),l>u.length&&r("Syntax error, steps cannot be greater than maximum value of part ("+u.length+")"),n=0;n<u.length;n+=l)u[n+s]=1;else n=parseInt(e,10)+s,(n<0||n>=u.length)&&r(t+" value out of range: '"+e+"'"),u[n]=1;else for(n=0;n<u.length;n++)u[n]=1},i.prototype.next=function(t){let e=this._next(t);return e&&e.setMilliseconds(0),e},i.prototype.previous=function(){return this.opts.previous},i.prototype._next=function(t){if(t=t||new Date,this.opts.startAt&&t<this.opts.startAt&&(t=this.opts.startAt),this.opts.maxRuns<=0||this.opts.kill)return;let e,s=this.opts.stopAt||this.schedulerDefaults.stopAt,r=new a(t);return r.increment(this.pattern),e=r.getDate(),s&&e>=s?void 0:e},i.prototype.validateOpts=function(t){return t.startAt&&(t.startAt.constructor!==Date?t.startAt=new Date(Date.parse(t.startAt)-1):t.startAt=new Date(t.startAt.getTime()-1),isNaN(t.startAt)&&r("Provided value for startAt could not be parsed as date.")),t.stopAt&&(t.stopAt.constructor!==Date&&(t.stopAt=new Date(Date.parse(t.stopAt))),isNaN(t.stopAt)&&r("Provided value for stopAt could not be parsed as date.")),t},i.prototype.msToNext=function(t){t=t||new Date;let e=this._next(t);return e?this._next(t)-t.getTime():e},i.prototype.schedule=function(t,e){let r,n=this,a=n.maxDelay||s;if(e||(e=t,t={}),t.paused=void 0!==t.paused&&t.paused,t.kill=t.kill||this.schedulerDefaults.kill,t.rest=t.rest||0,t.maxRuns||0===t.maxRuns||(t.maxRuns=this.schedulerDefaults.maxRuns),n.opts=n.validateOpts(t||{}),r=this.msToNext(t.previous),void 0!==r)return r>a&&(r=a),t.currentTimeout=setTimeout((function(){r!==a&&(t.paused||(t.maxRuns--,e()),t.previous=new Date),n.schedule(t,e)}),r),{stop:function(){t.kill=!0,t.currentTimeout&&clearTimeout(t.currentTimeout)},pause:function(){return(t.paused=!0)&&!t.kill},resume:function(){return!(t.paused=!1)&&!t.kill}}};var l=e.P,u=e.Z;export{l as Cron,u as default};