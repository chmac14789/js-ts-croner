!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.Cron=e():t.Cron=e()}(this,(function(){return(()=>{"use strict";var t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)},e={};function r(t){if(t&&t instanceof Date)this.fromDate(t);else if(void 0===t)this.fromDate(new Date);else if(t&&"string"==typeof t)this.fromString(t);else{if(!(t instanceof r))throw new TypeError("CronDate: Invalid type passed as parameter to CronDate constructor");this.fromCronDate(t)}}function n(t){this.pattern=t,this.seconds=Array(60).fill(0),this.minutes=Array(60).fill(0),this.hours=Array(24).fill(0),this.days=Array(31).fill(0),this.months=Array(12).fill(0),this.daysOfWeek=Array(8).fill(0),this.parse()}t.d(e,{default:()=>i}),r.prototype.fromDate=function(t){this.milliseconds=t.getMilliseconds(),this.seconds=t.getSeconds(),this.minutes=t.getMinutes(),this.hours=t.getHours(),this.days=t.getDate(),this.months=t.getMonth(),this.years=t.getFullYear()},r.prototype.fromCronDate=function(t){this.milliseconds=t.milliseconds,this.seconds=t.seconds,this.minutes=t.minutes,this.hours=t.hours,this.days=t.days,this.months=t.months,this.years=t.years},r.prototype.fromString=function(t){let e=Date.parse(t);if(isNaN(e))throw new TypeError("CronDate: Provided string value for CronDate could not be parsed as date.");this.fromDate(new Date(e))},r.prototype.increment=function(t){this.seconds+=1,this.milliseconds=0;let e=this,r=function(t,r,n,s){for(let o=void 0===s?e[t]+n:0+n;o<r[t].length;o++)if(r[t][o])return e[t]=o-n,!0;return!1},n=[["seconds","minutes",0],["minutes","hours",0],["hours","days",0],["days","months",-1],["months","years",0]],s=0;for(;s<5;){if(!r(n[s][0],t,n[s][2]))for(this[n[s][1]]++;s>=0;)r(n[s][0],t,n[s][2],0),s--;s++}for(;!t.daysOfWeek[this.getDate().getDay()];)this.days+=1;return this},r.prototype.getDate=function(){return new Date(this.years,this.months,this.days,this.hours,this.minutes,this.seconds,this.milliseconds)},r.prototype.getTime=function(){return new Date(this.years,this.months,this.days,this.hours,this.minutes,this.seconds,this.milliseconds).getTime()},n.prototype.parse=function(){if("string"!=typeof this.pattern&&this.pattern.constructor!==String)throw new TypeError("CronPattern: Pattern has to be of type string.");let t,e,r,n,s,o=this.pattern.trim().replace(/\s+/g," ").split(" "),i=/[^/*0-9,-]+/;if(o.length<5||o.length>6)throw new TypeError("CronPattern: invalid configuration format ('"+this.pattern+"'), exacly five or six space separated parts required.");for(5===o.length&&o.unshift("0"),e=0;e<o.length;e++)if(t=o[e].trim(),i.test(t))throw new TypeError("CronPattern: configuration entry "+(e+1)+" ("+t+") contains illegal characters.");if(r="*"!==o[4],n="*"!==o[5],s="*"!==o[3],n&&(r||s))throw new TypeError("CronPattern: configuration invalid, you can not combine month/date with day of week.");this.partToArray("seconds",o[0],0),this.partToArray("minutes",o[1],0),this.partToArray("hours",o[2],0),this.partToArray("days",o[3],-1),this.partToArray("months",o[4],-1),this.partToArray("daysOfWeek",o[5],0),this.daysOfWeek[7]&&(this.daysOfWeek[0]=1)},n.prototype.partToArray=function(t,e,r){let n,s,o,i,a,h=this[t];if("*"!==e)if(s=e.split(","),s.length>1)for(n=0;n<s.length;n++)this.partToArray(t,s[n],r);else if(-1!==e.indexOf("-")){if(s=e.split("-"),2!==s.length)throw new TypeError("CronPattern: Syntax error, illegal range: '"+e+"'");if(o=parseInt(s[0],10)+r,i=parseInt(s[1],10)+r,isNaN(o))throw new TypeError("CronPattern: Syntax error, illegal lower range (NaN)");if(isNaN(i))throw new TypeError("CronPattern: Syntax error, illegal upper range (NaN)");if(o<0||i>=h.length)throw new TypeError("CronPattern: Value out of range: '"+e+"'");if(o>i)throw new TypeError("CronPattern: From value is larger than to value: '"+e+"'");for(n=o;n<=i;n++)h[n+r]=1}else if(-1!==e.indexOf("/")){if(s=e.split("/"),2!==s.length)throw new TypeError("CronPattern: Syntax error, illegal stepping: '"+e+"'");if("*"!==s[0])throw new TypeError("CronPattern: Syntax error, left part of / needs to be * : '"+e+"'");if(a=parseInt(s[1],10),isNaN(a))throw new TypeError("CronPattern: Syntax error, illegal stepping: (NaN)");if(0===a)throw new TypeError("CronPattern: Syntax error, illegal stepping: 0");if(a>h.length)throw new TypeError("CronPattern: Syntax error, steps cannot be greater than maximum value of part ("+h.length+")");for(n=0;n<h.length;n+=a)h[n+r]=1}else{if(n=parseInt(e,10)+r,n<0||n>=h.length)throw new TypeError("CronPattern: "+t+" value out of range: '"+e+"'");h[n]=1}else for(n=0;n<h.length;n++)h[n]=1};const s=Math.pow(2,31)-1;function o(t,e,r){let s=this;return this instanceof o?(s.pattern=new n(t),s.schedulerDefaults={maxRuns:1/0,kill:!1},"function"==typeof e&&(r=e,e={}),s.opts=s.validateOpts(e||{}),void 0===r?s:this.schedule(e,r)):new o(t,e,r)}o.prototype.next=function(t){let e=this._next(t);return e?e.getDate():null},o.prototype.previous=function(){return this.opts.previous?this.opts.previous.getDate():null},o.prototype._next=function(t){t=new r(t),this.opts.startAt&&t&&t.getTime()<this.opts.startAt.getTime()&&(t=new r(this.opts.startAt));let e=new r(t).increment(this.pattern);return this.opts.maxRuns<=0||this.opts.kill||this.opts.stopAt&&e.getTime()>=this.opts.stopAt.getTime()?null:e},o.prototype.validateOpts=function(t){return t.startAt&&(t.startAt=new r(t.startAt)),t.stopAt&&(t.stopAt=new r(t.stopAt)),t},o.prototype.msToNext=function(t){t=t||new r;let e=this._next(t);return e?e.getTime()-t.getTime():null},o.prototype.schedule=function(t,e){let n,o=this,i=o.maxDelay||s;if(e||(e=t,t=o.opts),t.paused=void 0!==t.paused&&t.paused,t.kill=t.kill||this.schedulerDefaults.kill,t.maxRuns||0===t.maxRuns||(t.maxRuns=this.schedulerDefaults.maxRuns),o.opts=o.validateOpts(t||{}),n=this.msToNext(t.previous),null!==n)return n>i&&(n=i),t.currentTimeout=setTimeout((function(){n!==i&&(t.paused||(t.maxRuns--,e()),t.previous=new r),o.schedule(t,e)}),n),{stop:function(){t.kill=!0,t.currentTimeout&&clearTimeout(t.currentTimeout)},pause:function(){return(t.paused=!0)&&!t.kill},resume:function(){return!(t.paused=!1)&&!t.kill}}};const i=o;return e.default})()}));